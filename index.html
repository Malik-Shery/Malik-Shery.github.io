<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>3D Running Man Game</title>
    <style>
        body {
            margin: 0;
            overflow: hidden;
            background-color: #87CEEB; /* Sky Blue */
        }
        canvas {
            display: block;
        }
        #startButton {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 24px;
            padding: 20px;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 10px;
            cursor: pointer;
        }
        #startButton:hover {
            background-color: #45a049;
        }
    </style>
</head>
<body>

<!-- Start Button -->
<button id="startButton">Start Game</button>

<script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
<script>
    let scene, camera, renderer;
    let player, playerSpeed = 0.1;
    let ground;
    let gameOver = false;
    let gameStarted = false;

    // Initialize the scene (only creates the scene and player, does not start the game)
    function init() {
        // Create scene, camera, and renderer
        scene = new THREE.Scene();
        camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
        renderer = new THREE.WebGLRenderer();
        renderer.setSize(window.innerWidth, window.innerHeight);
        document.body.appendChild(renderer.domElement);

        // Add a ground
        const groundGeometry = new THREE.PlaneGeometry(200, 200);
        const groundMaterial = new THREE.MeshBasicMaterial({ color: 0x228B22, side: THREE.DoubleSide });
        ground = new THREE.Mesh(groundGeometry, groundMaterial);
        ground.rotation.x = -Math.PI / 2; // Rotate to lay flat
        scene.add(ground);

        // Create the "man" (represented by a simple box)
        const playerGeometry = new THREE.BoxGeometry(1, 2, 1);
        const playerMaterial = new THREE.MeshBasicMaterial({ color: 0x0000FF });
        player = new THREE.Mesh(playerGeometry, playerMaterial);
        player.position.set(0, 1, 0);
        scene.add(player);

        // Add obstacles to avoid
        createObstacle();

        // Set the camera position to follow the player
        camera.position.set(0, 2, 5);
        camera.lookAt(player.position);

        // Hide the game initially until the start button is clicked
        renderer.domElement.style.display = "none";
    }

    // Create obstacles
    function createObstacle() {
        const obstacleGeometry = new THREE.BoxGeometry(3, 1, 1);
        const obstacleMaterial = new THREE.MeshBasicMaterial({ color: 0xff0000 });
        const obstacle = new THREE.Mesh(obstacleGeometry, obstacleMaterial);
        obstacle.position.set(Math.random() * 10 - 5, 0.5, -10); // Position obstacles randomly
        scene.add(obstacle);
    }

    // Start the game
    function startGame() {
        document.getElementById("startButton").style.display = "none"; // Hide start button
        renderer.domElement.style.display = "block"; // Show the 3D canvas

        gameStarted = true;
        animate();
    }

    // Update function to handle movement and animation
    function update() {
        if (gameOver) return;

        // Move the player forward (simulate running)
        player.position.z -= playerSpeed;

        // Move obstacles toward the player
        scene.children.forEach(child => {
            if (child.position.z > player.position.z + 20 && child !== player && child !== ground) {
                child.position.z = -10;  // Reset obstacle position behind the player
                child.position.x = Math.random() * 10 - 5; // Random horizontal position
            } else if (child !== player && child !== ground) {
                child.position.z += playerSpeed;  // Move obstacle forward
            }
        });

        // Collision detection (simple)
        scene.children.forEach(child => {
            if (child !== player && child !== ground) {
                const dist = player.position.distanceTo(child.position);
                if (dist < 2) {
                    gameOver = true;
                    alert("Game Over! You hit an obstacle!");
                    resetGame();
                }
            }
        });
    }

    // Reset game
    function resetGame() {
        gameOver = false;
        player.position.set(0, 1, 0);
        score = 0;
        scene.children.forEach(child => {
            if (child !== ground && child !== player) {
                scene.remove(child); // Remove obstacles
            }
        });
        createObstacle(); // Add a new obstacle
    }

    // Animate the scene
    function animate() {
        if (!gameStarted) return; // Wait for the game to start

        requestAnimationFrame(animate);

        // Update game logic
        update();

        // Render the scene
        renderer.render(scene, camera);
    }

    // Initialize the game
    init();

    // Listen for the start button click
    document.getElementById("startButton").addEventListener("click", startGame);

</script>

</body>
</html>
